<!-- 标题 -->
<h1 class="w3-center w3-padding-64 w3-tangerine"><span class="w3-tag w3-wide">Java ASM</span></h1>
<!-- 内容 -->

<div style="text-align: right">
    <a href="javascript:void(0);" onclick="toggle_all_sub_note()">Toggle Commentary</a>
</div>

<h2>Intro</h2>

<p>
    无论操作字节码（ByteCode）的类库（ASM、Javassist、BCEL）如何千变万化，它的本质都是在理解Java ClassFile的结构。
</p>

<p>
    要有思维导图，要有破解软件
</p>



<p>
    有人讲到Spring-core用到ASM，我要调查一下。
</p>

<p>
    有一些学术论文，在讨论ASM的使用。
</p>

<p>
    TODO: 要有obfuscator的示例。
</p>



<ul>
    <li>
        第一部分，先提供一些实践，让人可以有一些了解；第二部分，再讲一些理论的东西。
    </li>
    <li>

    </li>
</ul>

<p>
    Execution Model是一个要记住的东西。
</p>

<p>
    分为参考性的内容（比如，Type类型，它主要是API的讲解）和学习性的内容
</p>

<p>
    所有jar包里的内容，是不是都要涉及到呢？
</p>

<p>
    TODO:
</p>

<ul>
    <li>
        <input type="checkbox"/>
        <code>ClassReader.accept(final ClassVisitor classVisitor, final int parsingOptions)</code>，对于<code>parsingOptions</code>的理解:
        <code>SKIP_CODE</code>、<code>SKIP_DEBUG</code>、<code>SKIP_FRAMES</code>、<code>EXPAND_FRAMES</code>
    </li>
    <li>
        <input type="checkbox"/>
        <code>ClassWriter(final ClassReader classReader, final int flags)</code>，对于<code>flags</code>的理解: <code>COMPUTE_MAXS</code>、<code>COMPUTE_FRAMES</code>
    </li>
    <li>
        <input type="checkbox"/>
        ASM版本信息，哪一个版本是在哪一年发布的，它都支持哪些特性。我想把它放在最后面，因为首先是对它有一个基本的了解，然后再对它的版本发布感兴趣。
    </li>
    <li>
        <input type="checkbox"/>
        如果在生成opcode的过程中，没有写<code>mv.visitInsn(RETURN);</code>会出现什么错误呢？
    </li>
    <li>
        <input type="checkbox"/>
        TryCatchBlock
    </li>
    <li>
        <input type="checkbox"/>
        visitLineNumber
    </li>
    <li>
        <input type="checkbox"/>
        visitParameter
    </li>
    <li>
        <input type="checkbox"/>
        frame是如何计算的呢？
    </li>
    <li>
        <input type="checkbox"/>
        visitLocalVariable
    </li>
    <li>
        工具的有限性，我们知道工具的有限性，ASM它是一个工具。有限性怎么理解呢？第一方面，并不是所有的功能都要通过ASM来进行实现，如果能通过写Java源代码实现，就不需要用ASM，这里主要是讲“用或者不用ASM”；第二方面，就是ASM的功能的有限性，有些功能ASM并没有提供给我们，我们需要自己来进行实现。
    </li>
</ul>

<h2>Main Content</h2>

<p>
    有三个基本操作：analyse、generate和transform，其中transform是最重要的操作。
    transform的目标有ClassInfo、Field和Method，其中对于Method的变换是最重要的。
</p>

<p>
    理论
</p>

<ul>
    <li>
        <a href="javascript:void(0);" onclick="$(this).next().next().toggle()">ASM Intro</a>
        <img src="/images/list.png" onclick="$(this).next().toggle()"/>
        <ul style="display: none;">
            <li>
                <a href="/archive/java/asm/asm_intro.html">ASM Intro</a>
            </li>
            <li>
                <a href="/archive/java/asm/asm_overview.html">ASM Overview</a>
            </li>
            <li>
                <a href="/archive/java/asm/asm_architecture.html">ASM Architecture</a>
            </li>
            <li>
                <a href="/archive/java/asm/asm_course.html">课程内容规划</a>
            </li>
        </ul>
    </li>
    <li>
        <a href="javascript:void(0);" onclick="$(this).next().next().toggle()">ASM Core API</a>
        <img src="/images/list.png" onclick="$(this).next().toggle()"/>
        <ul>
            <li><a href="/archive/java/asm/core/core_api_overview.html">Core API Overview</a></li>
            <li>
                ClassVisitor:
                <a href="/archive/java/asm/core/class_visitor_intro.html">Intro</a>
            </li>
            <li>
                ClassWriter:
                <a href="/archive/java/asm/core/class_writer_intro.html">Intro</a>
                <a href="/archive/java/asm/core/class_writer_examples.html">Examples</a>
                <a href="/archive/java/asm/core/class_writer_options.html">Options</a>
            </li>
            <li>
                FieldVisitor and FieldWriter:
                <a href="/archive/java/asm/core/field_visitor_and_field_writer_intro.html">Intro</a>
                <a href="/archive/java/asm/core/field_visitor_and_field_writer_examples.html">Examples</a>
            </li>
            <li>
                MethodVisitor and MethodWriter:
                <a href="/archive/java/asm/core/method_visitor_and_method_writer_intro.html">Intro</a>
                <a href="/archive/java/asm/core/method_visitor_and_method_writer_examples.html">Examples</a>
            </li>
            <li>
                ClassReader:
                <a href="/archive/java/asm/core/class_reader_intro.html">Intro</a>
                <a href="/archive/java/asm/core/class_reader_examples_01.html">Examples-01</a>
                <a href="/archive/java/asm/core/class_reader_examples_02.html">Examples-02</a>
                <a href="/archive/java/asm/core/class_reader_examples_03.html">Examples-03</a>
                <a href="/archive/java/asm/core/class_reader_options.html">Options</a>
            </li>
            <li><a href="/archive/java/asm/core/remove_class_members.html">Removing class members</a></li>
            <li><a href="/archive/java/asm/core/add_class_members.html">Adding class members</a></li>
            <li><a href="/archive/java/asm/core/type.html">Type</a></li>
            <li><a href="/archive/java/asm/core/util/trace_class_visitor.html">Tools: TraceClassVisitor</a></li>
            <li><a href="/archive/java/asm/core/util/check_class_adapter.html">Tools: CheckClassAdapter</a></li>
            <li><a href="/archive/java/asm/core/util/asmifier.html">Tools: ASMifier</a></li>
            <li><a href="/archive/java/asm/core/method_visitor.html">MethodVisitor</a></li>
            <li><a href="/archive/java/asm/core/generate_methods.html">Generating methods</a></li>
            <li><a href="/archive/java/asm/core/transform_methods.html">Transforming methods</a></li>
            <li><a href="/archive/java/asm/core/stateless_transformations.html">Stateless transformations</a></li>
            <li><a href="/archive/java/asm/core/stateful_transformations.html">Stateful transformations</a></li>
            <li><a href="/archive/java/asm/core/commons/analyzer_adapter.html">AnalyzerAdapter</a></li>
            <li><a href="/archive/java/asm/core/commons/local_variables_sorter.html">LocalVariablesSorter</a></li>
            <li><a href="/archive/java/asm/core/try_catch.html">Try Catch</a></li>
        </ul>
    </li>
    <li>
        <a href="javascript:void(0);" onclick="$(this).next().next().toggle()">ASM Tree API</a>
        <img src="/images/list.png" onclick="$(this).next().toggle()"/>
        <ul style="display: none;">
            <li><a href="/archive/java/asm/tree/tree_api_overview.html">Tree API Overview</a></li>
            <li><a href="/archive/java/asm/tree/class_node_intro.html">ClassNode Intro</a></li>
            <li><a href="/archive/java/asm/tree/class_node_examples.html">ClassNode Examples</a></li>
            <li><a href="/archive/java/asm/tree/field_node.html">FieldNode</a></li>
            <li><a href="/archive/java/asm/tree/method_node.html">MethodNode</a></li>
            <li><a href="/archive/java/asm/tree/pattern.html">Core And Tree Pattern</a></li>
        </ul>
    </li>
    <li>
        <a href="javascript:void(0);" onclick="$(this).next().next().toggle()">ASM Common Transformations</a>
        <img src="/images/list.png" onclick="$(this).next().toggle()"/>
        <ul style="display: none;">
            <li>
                Class Transformations
                <ul>
                    <li><a href="/archive/java/asm/template/interface_add.html">Introducing Interface</a></li>
                    <li><a href="/archive/java/asm/template/field_add.html">Adding a New Field</a></li>
                    <li><a href="/archive/java/asm/template/method_add.html">Adding a New Method</a></li>
                    <li><a href="/archive/java/asm/template/method_replace.html">Replace Method Body</a></li>
                    <li><a href="/archive/java/asm/template/class_rename.html">Renaming a Class</a></li>
                    <li><a href="/archive/java/asm/template/class_merge.html">Merging Two Classes into One</a></li>
                </ul>
            </li>
            <li>
                Method Transformations
                <ul>
                    <li><a href="/archive/java/asm/template/code_inserted_before_execution.html">Insert Code before Method, Constructor or Static Initializer Execution</a></li>
                    <li><a href="/archive/java/asm/template/code_inserted_before_exit.html">Insert Code before Method Exit</a></li>
                    <li><a href="/archive/java/asm/template/field_access_replace.html">Replace Field Access</a></li>
                    <li><a href="/archive/java/asm/template/method_call_replace.html">Replace Method Call</a></li>
                </ul>
            </li>


        </ul>
    </li>
    <li>
        <a href="javascript:void(0);" onclick="$(this).next().next().toggle()">ASM Metadata</a>
        <img src="/images/list.png" onclick="$(this).next().toggle()"/>
        <ul style="display: none;">
            <li>
                <a href="/archive/java/asm/metadata/debug_info.html">Debug Info</a>
            </li>
            <li>
                <a href="/archive/java/asm/metadata/annotations.html">Annotations</a>
            </li>
            <li>
                <a href="/archive/java/asm/metadata/generics.html">Generics</a>
            </li>
        </ul>
    </li>
</ul>



<p>
    知识的组织形式 和 知识的教学形式 是不一样的。
</p>

<ul>
    <li>
        <a href="javascript:void(0);" onclick="$(this).next().next().toggle()">Core API</a>
        <img src="/images/list.png" onclick="$(this).next().toggle()"/>
        <ul>
            <li>
                Field
                <ul>
                    <li><a href="/archive/java/asm/core/remove_class_members.html">Removing class members</a></li>
                </ul>
            </li>
        </ul>
    </li>
</ul>

<p>
    应用
</p>

<ul>
    <li>
        方法
        <ul>
            <li>Intercepting parameter values passed between methods</li>
            <li>calculation of execution time of methods</li>
        </ul>
    </li>
</ul>

<h2>More</h2>



<ul>
    <li>
        <p>
            <a class="external" href="https://en.wikipedia.org/wiki/FindBugs" target="_blank">FindBugs</a> uses BCEL to analyze Java bytecode for code idioms which indicate bugs.
        </p>
    </li>
    <li>
        Obfuscation
    </li>
</ul>

<div class="w3-panel w3-pale-blue w3-leftbar w3-border-blue">
    <ul>
        <li>
            <code>org.objectweb.asm</code>(<code>asm.jar</code>): <code>ClassVisitor</code>, <code>ClassReader</code>, <code>ClassWriter</code>, <code>Type</code>.
        </li>
        <li>
            <code>org.objectweb.asm.commons</code>(<code>asm-commons.jar</code>): <code>AnalyzerAdapter</code>, <code>LocalVariablesSorter</code>, <code>AdviceAdapter</code>.
        </li>
        <li>
            <code>org.objectweb.asm.util</code>(<code>asm-util.jar</code>): <code>TraceClassVisitor</code>, <code>CheckClassAdapter</code>.
        </li>
    </ul>
</div>

<h2>Resources</h2>

<ul>
    <li><a class="external" href="https://asm.ow2.io" target="_blank">ASM</a></li>
    <li><a class="external" href="https://asm.ow2.io/asm4-guide.pdf" target="_blank">ASM User Guild (PDF)</a></li>
    <li><a class="external" href="https://asm.ow2.io/javadoc/overview-summary.html" target="_blank">ASM Javadoc</a></li>
    <li><a class="external" href="https://asm.ow2.io/developer-guide.html" target="_blank">ASM 6 Developer Guide</a></li>
    <li><a class="external" href="https://asm.ow2.io/faq.html" target="_blank">ASM Frequently Asked Questions</a></li>
    <li><a class="external" href="https://gitlab.ow2.org/asm/asm" target="_blank">GitLab: ASM Source Code</a></li>
    <li><a class="external" href="https://github.com/cglib/cglib" target="_blank">Github: cglib</a>: Byte Code Generation Library is high level API to generate and transform JAVA byte code.</li>
    <li><a class="external" href="https://github.com/cobertura/cobertura" target="_blank">Github: COBERTURA</a>: Cobertura is a free Java code coverage reporting tool.</li>
    <li><a class="external" href="https://www.eclemma.org/jacoco/" target="_blank">EclEmma: JaCoCo</a>: Java Code Coverage Library. JaCoCo is a free code coverage library for Java, which has been created by the EclEmma team based on the lessons learned from using and integration existing libraries for many years.</li>
    <li>
        The Java Virtual Machine Specification, Java SE 8 Edition:
        <a class="external" href="https://docs.oracle.com/javase/specs/jvms/se8/html/index.html" target="_blank">Oracle</a>
        <a href="/doc/javase/jvms/se8/index.html" target="_blank">Local</a>
    </li>
</ul>
